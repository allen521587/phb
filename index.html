<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>日本驾照刷题</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="app">
  <h1>日本换驾照 · 刷题</h1>

  <div id="start-screen">
    <button onclick="startQuiz()">开始答题</button>
  </div>

  <div id="quiz-screen" class="hidden">
    <div id="progress"></div>
    <div id="question"></div>
    <div id="options"></div>
  </div>

  <div id="result-screen" class="hidden">
    <h2>完成</h2>
    <p id="score"></p>
    <button onclick="startQuiz()">再来一次</button>
  </div>
</div>

<script src="questions.js"></script>
<script>
let current = 0;
let score = 0;
let quiz = [];

function startQuiz() {
  quiz = shuffle([...questions]);
  current = 0;
  score = 0;

  show("quiz-screen");
  hide("start-screen");
  hide("result-screen");

  showQuestion();
}

function showQuestion() {
  const q = quiz[current];
  document.getElementById("progress").innerText =
    `第 ${current + 1} / ${quiz.length} 题`;

  document.getElementById("question").innerText = q.text;

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";

  q.options.forEach((opt, i) => {
    const btn = document.createElement("button");
    btn.innerText = opt;
    btn.onclick = () => selectAnswer(i);
    optionsDiv.appendChild(btn);
  });
}

function selectAnswer(i) {
  if (i === quiz[current].answer) score++;
  current++;

  if (current < quiz.length) {
    showQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  hide("quiz-screen");
  show("result-screen");
  document.getElementById("score").innerText =
    `正确 ${score} / ${quiz.length}`;
}

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

function show(id) {
  document.getElementById(id).classList.remove("hidden");
}

function hide(id) {
  document.getElementById(id).classList.add("hidden");
}
</script>

</body>
</html>
